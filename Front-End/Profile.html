<!DOCTYPE html>


<html style="height:100%;">

<head>
    <meta charset="utf-8">
    <title> Study Buddy|Profile </title>
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="css/style.css">
    <script>
        //Checking if the account is logged in
    if(sessionStorage.token==null){
       alert('You are not logged in');
       window.location.href="Login.html";
    }
    </script>

</head>
<body>

    <header id="head2">
        <div class="container">
            <div id="branding">
                <h1>
                    Profile
                </h1>
            </div>
            <nav>
               
                <a  href="Home.html">HOME</a>
                <a  href="new 4.html">ABOUT US </a>
            </nav>

        </div>
     
             
    </header>
    <div id="main">
          <!-- Building the fields to show on display for the profile -->
          
          <form name='sform' id='sform'>
          Username:<br>
          <input id="Ulabel" disabled  style="background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px; ">
        <span id='Pass'></span>
         
         <br>
          Email:<br>
          <input id="Elabel" disabled  style="background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;">

          <br>
          Phone:<br>
          <input id="Plabel" disabled  style="background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;">

          <br>
          JoinDate:<br>
          <input id="JDlabel" disabled  style="background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;">

          <br>
          Year:<br>
          <input id="Ylabel" disabled  style="background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;">

          <br>
          Department:<br>
          <input id="Dlabel" disabled  style="background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;">

        <br>
          <button name="Edit" id="Edit" >Edit</button>
          <br>
        </form>

    </div>
    
   

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script> 
    var Id={userId: sessionStorage.getItem('ID')};
    var U=document.getElementById('Ulabel');
    var P=document.getElementById('Plabel');
    var E=document.getElementById('Elabel');
    var D=document.getElementById('Dlabel');
    var Y=document.getElementById('Ylabel');
    $(document).ready(function(){
    $.ajax({
        type:"POST", 
        url :'http://localhost:3000/api/userinfo',
        data: Id,
        headers: {
            "x-access-token": sessionStorage.getItem('token')
        },
        success:function(response){
            console.log(response);
                if(!(response.Error)){                 
                    U.value=response.userInfo.user_name;
                    P.value=response.userInfo.user_phone;
                    E.value=response.userInfo.user_email;
                    D.value=response.userInfo.user_department;
                    Y.value=response.userInfo.user_year;
            }
            
        },
        error: function(){
            console.log("Error in connection");
            
        },
        
    
    });
})
    $('#Edit').on('click',function(){
        //document.getElementById('main').innerHTML+=''

        if($(U).attr('disabled')){
            document.getElementById('Pass').innerHTML='<br> Password:<br> <input >'
            $(U).removeAttr('disabled');
            $(U).removeAttr('style');
            $(P).removeAttr('disabled');
            $(P).removeAttr('style');
            $(E).removeAttr('disabled');
            $(E).removeAttr('style');
            $(D).removeAttr('disabled');
            $(D).removeAttr('style');
            $(Y).removeAttr('disabled');
            $(Y).removeAttr('style');
        }
        else{
            document.getElementById('Pass').innerHTML='';
           /*
           $.ajax({
                    type:"POST", 
                    url :'http://localhost:3000/api/userinfo',
                    data: Id,
                    headers: {
                        "x-access-token": sessionStorage.getItem('token')
                    },
                    success:function(response){
                        console.log(response);
                            if(!(response.Error)){                 
                                U.value=response.userInfo.user_name;
                                P.value=response.userInfo.user_phone;
                                E.value=response.userInfo.user_email;
                                D.value=response.userInfo.user_department;
                                Y.value=response.userInfo.user_year;
                        }
                        
                    },
                    error: function(){
                        console.log("Error in connection");
                        
                    },
                    
                
                });*/
           $.ajax({
            type:"POST", 
                url :'http://localhost:3000/api/setData',
                data: $('#sform').serialize(),
                headers: {
                    "x-access-token": sessionStorage.getItem('token')
                },
                success:function(response){
                    console.log(response);
                    
                },
                error: function(){
                    console.log("Error in connection");
                    
                },
           })         
            
           U.setAttribute('disabled','disabled');
           U.setAttribute('style','background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;');
           P.setAttribute('disabled','disabled');
           P.setAttribute('style','background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;');
           E.setAttribute('disabled','disabled');
           E.setAttribute('style','background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;')
           D.setAttribute('disabled','disabled');
           D.setAttribute('style','background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;')
           Y.setAttribute('disabled','disabled');
           Y.setAttribute('style','background-color:#35424a; border:none; color:darkgoldenrod; Font-size:15px;')
        
        
        }
       
    })
    
    
    </script>


</body>
</html>
